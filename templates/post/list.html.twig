{% extends 'base.html.twig' %}

{% block title %}List Posts{% endblock %}

{% block body %}
<div class="blog-content-wrapper">
    <h1>List of Blog Posts</h1>

    {% if is_granted('ROLE_USER') %}
        <a href="{{ path('create_post') }}" class="btn btn-primary">Create Post</a>
    {% endif %}

    {% for post in blogPosts %}
        <div class="blog-post">
            <h2><a href="{{ path('post_show', {'id': post.id}) }}">{{ post.title }}</a></h2>
            <p>{{ post.content }}</p>
            <p><small>Posted on {{ post.createdAt|date('d.m.Y h:i') }}</small></p>
            {% if is_granted('ROLE_ADMIN') %}
                <form method="post" action="{{ path('post_delete', {'id': post.id}) }}" onsubmit="return confirm('Are you sure you want to delete this post?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
                    <button class="btn btn-danger">Delete</button>
                </form>
            {% endif %}
        </div>
    {% else %}
        <p>No blog posts found.</p>
    {% endfor %}
</div>
{% endblock %}